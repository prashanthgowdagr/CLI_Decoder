<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Content-Security-Policy"
    content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src https://fonts.gstatic.com; img-src 'self' data:;" />
  <meta http-equiv="X-Content-Type-Options" content="nosniff" />
  <meta http-equiv="Referrer-Policy" content="no-referrer" />
  <title>CLIDecoder â€” Command Explainer</title>
  <meta name="description"
    content="Paste any CLI command and get a colour-coded, part-by-part explanation instantly â€” no API key needed." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link
    href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;700&family=Syne:wght@400;600;700;800&display=swap"
    rel="stylesheet" />
  <style>
    /* â”€â”€ TOKENS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    :root {
      --clr-cmd: #f97316;
      --clr-sub: #a78bfa;
      --clr-flag: #34d399;
      --clr-arg: #60a5fa;
      --clr-val: #fbbf24;
      --clr-pipe: #f472b6;
      --clr-other: #94a3b8;
      --radius: 10px;
      --transition: 0.25s cubic-bezier(.4, 0, .2, 1);
    }

    [data-theme="dark"] {
      --bg: #0d0f14;
      --surface: #161922;
      --surface2: #1e2230;
      --border: #2a2f3d;
      --text: #e2e8f0;
      --text-muted: #64748b;
      --glow: rgba(99, 102, 241, .25);
      --input-bg: #0a0c10;
    }

    [data-theme="light"] {
      --bg: #f4f6fb;
      --surface: #ffffff;
      --surface2: #eef1f8;
      --border: #d1d8e8;
      --text: #1e2330;
      --text-muted: #6b7a99;
      --glow: rgba(99, 102, 241, .12);
      --input-bg: #f9fafc;
      --clr-cmd: #d6450a;
      --clr-sub: #7c3aed;
      --clr-flag: #059669;
      --clr-arg: #2563eb;
      --clr-val: #b45309;
      --clr-pipe: #be185d;
      --clr-other: #475569;
    }

    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Syne', sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      transition: background var(--transition), color var(--transition);
      overflow-x: hidden;
    }

    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image:
        linear-gradient(rgba(99, 102, 241, .04) 1px, transparent 1px),
        linear-gradient(90deg, rgba(99, 102, 241, .04) 1px, transparent 1px);
      background-size: 40px 40px;
      pointer-events: none;
      z-index: 0;
    }

    .page {
      position: relative;
      z-index: 1;
      max-width: 900px;
      margin: 0 auto;
      padding: 28px 20px 80px;
    }

    /* â”€â”€ HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 40px;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo-icon {
      width: 38px;
      height: 38px;
      background: linear-gradient(135deg, #6366f1, #a78bfa);
      border-radius: 10px;
      display: grid;
      place-items: center;
      font-family: 'JetBrains Mono', monospace;
      font-size: 15px;
      font-weight: 700;
      color: #fff;
      box-shadow: 0 0 20px var(--glow);
      user-select: none;
    }

    .logo-text {
      font-size: 20px;
      font-weight: 800;
      letter-spacing: -.5px;
    }

    .logo-text span {
      color: #6366f1;
    }

    /* "No API" badge */
    .no-api-badge {
      font-family: 'JetBrains Mono', monospace;
      font-size: 10px;
      font-weight: 700;
      padding: 4px 10px;
      border-radius: 99px;
      background: rgba(52, 211, 153, .12);
      border: 1px solid rgba(52, 211, 153, .3);
      color: #34d399;
      letter-spacing: .5px;
    }

    .theme-btn {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 40px;
      padding: 6px 14px;
      display: flex;
      align-items: center;
      gap: 7px;
      cursor: pointer;
      font-family: 'Syne', sans-serif;
      font-size: 13px;
      font-weight: 600;
      color: var(--text-muted);
      transition: all var(--transition);
    }

    .theme-btn:hover {
      color: var(--text);
      border-color: #6366f1;
      box-shadow: 0 0 12px var(--glow);
    }

    .theme-btn svg {
      width: 15px;
      height: 15px;
    }

    /* â”€â”€ HERO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .hero {
      text-align: center;
      margin-bottom: 36px;
    }

    .hero h1 {
      font-size: clamp(26px, 5vw, 42px);
      font-weight: 800;
      letter-spacing: -1px;
      line-height: 1.15;
      margin-bottom: 10px;
    }

    .hero h1 em {
      font-style: normal;
      color: #6366f1;
    }

    .hero p {
      color: var(--text-muted);
      font-size: 15px;
      max-width: 540px;
      margin: 0 auto;
    }

    /* â”€â”€ PLATFORM CHIPS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .platforms {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 8px;
      margin-bottom: 28px;
    }

    .chip {
      font-family: 'JetBrains Mono', monospace;
      font-size: 11px;
      font-weight: 500;
      padding: 5px 12px;
      border-radius: 99px;
      border: 1px solid var(--border);
      background: var(--surface);
      color: var(--text-muted);
      cursor: pointer;
      transition: all var(--transition);
      user-select: none;
    }

    .chip:hover,
    .chip.active {
      border-color: #6366f1;
      color: #818cf8;
      background: rgba(99, 102, 241, .08);
      box-shadow: 0 0 10px var(--glow);
    }

    /* â”€â”€ INPUT CARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .input-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 20px;
      margin-bottom: 24px;
      box-shadow: 0 4px 24px rgba(0, 0, 0, .12);
      transition: border-color var(--transition);
    }

    .input-card:focus-within {
      border-color: #6366f1;
      box-shadow: 0 0 0 3px var(--glow), 0 4px 24px rgba(0, 0, 0, .12);
    }

    .input-label {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 1.2px;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 10px;
      font-family: 'JetBrains Mono', monospace;
    }

    .input-row {
      display: flex;
      gap: 10px;
    }

    .cmd-input {
      flex: 1;
      background: var(--input-bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px 16px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 14px;
      color: var(--text);
      outline: none;
      transition: all var(--transition);
    }

    .cmd-input::placeholder {
      color: var(--text-muted);
      opacity: .6;
    }

    .cmd-input:focus {
      border-color: #6366f1;
    }

    .char-counter {
      font-family: 'JetBrains Mono', monospace;
      font-size: 10px;
      color: var(--text-muted);
      text-align: right;
      margin-top: 6px;
      opacity: .7;
      transition: color var(--transition);
    }

    .char-counter.warn {
      color: #f97316;
    }

    .char-counter.limit {
      color: #ef4444;
    }

    .explain-btn {
      background: linear-gradient(135deg, #6366f1, #818cf8);
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 12px 22px;
      font-family: 'Syne', sans-serif;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 7px;
      transition: all var(--transition);
      white-space: nowrap;
      align-self: flex-start;
    }

    .explain-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 20px rgba(99, 102, 241, .4);
    }

    .explain-btn svg {
      width: 15px;
      height: 15px;
    }

    /* â”€â”€ EXAMPLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .examples-label {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 1.2px;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 10px;
      font-family: 'JetBrains Mono', monospace;
    }

    .examples-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 32px;
    }

    .example-pill {
      font-family: 'JetBrains Mono', monospace;
      font-size: 11.5px;
      padding: 6px 12px;
      border-radius: 6px;
      background: var(--surface);
      border: 1px solid var(--border);
      color: var(--text-muted);
      cursor: pointer;
      transition: all var(--transition);
      white-space: nowrap;
    }

    .example-pill:hover {
      color: var(--text);
      border-color: #6366f1;
      background: rgba(99, 102, 241, .06);
    }

    /* â”€â”€ ERROR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .error-msg {
      background: rgba(239, 68, 68, .08);
      border: 1px solid rgba(239, 68, 68, .25);
      border-radius: 10px;
      padding: 14px 18px;
      font-size: 14px;
      color: #f87171;
      font-family: 'JetBrains Mono', monospace;
      display: none;
    }

    .error-msg.visible {
      display: block;
    }

    /* â”€â”€ RESULTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    #results {
      animation: fadeUp .4s ease both;
    }

    @keyframes fadeUp {
      from {
        opacity: 0;
        transform: translateY(12px);
      }

      to {
        opacity: 1;
        transform: none;
      }
    }

    .summary-bar {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 16px 20px;
      margin-bottom: 20px;
      font-size: 14px;
      line-height: 1.6;
      color: var(--text-muted);
    }

    .summary-bar strong {
      color: var(--text);
      font-weight: 600;
    }

    .coverage-badge {
      display: inline-block;
      font-family: 'JetBrains Mono', monospace;
      font-size: 10px;
      font-weight: 700;
      padding: 2px 8px;
      border-radius: 99px;
      margin-left: 8px;
      vertical-align: middle;
    }

    .coverage-full {
      background: rgba(52, 211, 153, .15);
      border: 1px solid rgba(52, 211, 153, .3);
      color: #34d399;
    }

    .coverage-part {
      background: rgba(251, 191, 36, .12);
      border: 1px solid rgba(251, 191, 36, .3);
      color: #fbbf24;
    }

    .coverage-none {
      background: rgba(148, 163, 184, .1);
      border: 1px solid rgba(148, 163, 184, .2);
      color: #94a3b8;
    }

    /* â”€â”€ COLORED COMMAND DISPLAY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .cmd-display {
      background: var(--input-bg);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 20px 24px;
      margin-bottom: 20px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 15px;
      line-height: 1.8;
      overflow-x: auto;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .cmd-display::before {
      content: '$ ';
      color: var(--text-muted);
      opacity: .5;
    }

    .t {
      display: inline;
      cursor: default;
      border-radius: 3px;
      padding: 1px 0;
      transition: background .15s;
    }

    .t:hover {
      background: rgba(255, 255, 255, .06);
    }

    [data-theme="light"] .t:hover {
      background: rgba(0, 0, 0, .06);
    }

    .t-cmd {
      color: var(--clr-cmd);
    }

    .t-sub {
      color: var(--clr-sub);
    }

    .t-flag {
      color: var(--clr-flag);
    }

    .t-arg {
      color: var(--clr-arg);
    }

    .t-val {
      color: var(--clr-val);
    }

    .t-pipe {
      color: var(--clr-pipe);
    }

    .t-other {
      color: var(--clr-other);
    }

    /* â”€â”€ LEGEND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .legend {
      display: flex;
      flex-wrap: wrap;
      gap: 14px;
      margin-bottom: 24px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 11px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 5px;
      color: var(--text-muted);
    }

    .legend-dot {
      width: 9px;
      height: 9px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    /* â”€â”€ PARTS GRID â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .parts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(330px, 1fr));
      gap: 14px;
    }

    .part-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px 18px;
      transition: border-color var(--transition), transform var(--transition);
      animation: fadeUp .4s ease both;
    }

    .part-card:hover {
      border-color: #6366f1;
      transform: translateY(-2px);
    }

    .part-card-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .part-token {
      font-family: 'JetBrains Mono', monospace;
      font-size: 14px;
      font-weight: 700;
      padding: 3px 10px;
      border-radius: 6px;
      background: var(--surface2);
    }

    .part-type-badge {
      font-size: 10px;
      font-weight: 700;
      letter-spacing: .8px;
      text-transform: uppercase;
      padding: 2px 8px;
      border-radius: 99px;
      background: var(--surface2);
      font-family: 'JetBrains Mono', monospace;
    }

    .part-desc {
      font-size: 13.5px;
      line-height: 1.6;
      color: var(--text-muted);
    }

    .part-unknown {
      font-style: italic;
      opacity: .7;
    }

    /* â”€â”€ UNKNOWN COMMAND NOTICE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .unknown-notice {
      background: rgba(99, 102, 241, .06);
      border: 1px dashed rgba(99, 102, 241, .25);
      border-radius: 10px;
      padding: 12px 16px;
      font-size: 13px;
      color: var(--text-muted);
      margin-bottom: 20px;
      line-height: 1.6;
    }

    /* â”€â”€ FOOTER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    footer {
      text-align: center;
      padding-top: 40px;
      font-size: 12px;
      color: var(--text-muted);
      font-family: 'JetBrains Mono', monospace;
      opacity: .6;
    }

    @media (max-width: 560px) {
      .parts-grid {
        grid-template-columns: 1fr;
      }

      .input-row {
        flex-direction: column;
      }

      .explain-btn {
        align-self: stretch;
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="page">

    <!-- HEADER -->
    <header>
      <div class="logo">
        <div class="logo-icon" aria-hidden="true">&gt;_</div>
        <div class="logo-text">CLI<span>Decoder</span></div>
        <span class="no-api-badge" title="Works entirely offline â€” no API key required">âœ“ No API Key</span>
      </div>
      <button class="theme-btn" onclick="toggleTheme()" id="themeBtn" aria-label="Toggle colour theme">
        <svg id="themeIcon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"
          stroke-width="2" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364-6.364l-.707.707M6.343 17.657l-.707.707M17.657 17.657l-.707-.707M6.343 6.343l-.707-.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
        </svg>
        <span id="themeLabel">Light Mode</span>
      </button>
    </header>

    <!-- HERO -->
    <div class="hero">
      <h1>Decode any <em>CLI command</em><br />in plain English</h1>
      <p>Paste a command below and get a colour-coded, part-by-part breakdown â€” instantly, in your browser, with
        <strong>no API key</strong> needed.
      </p>
    </div>

    <!-- PLATFORM CHIPS -->
    <div class="platforms" id="platforms" role="group" aria-label="Select platform context">
      <button class="chip active" data-platform="linux" type="button">ğŸ§ Linux</button>
      <button class="chip" data-platform="docker" type="button">ğŸ³ Docker</button>
      <button class="chip" data-platform="git" type="button">ğŸŒ¿ Git</button>
      <button class="chip" data-platform="kubernetes" type="button">â˜¸ï¸ Kubernetes</button>
      <button class="chip" data-platform="aws" type="button">â˜ï¸ AWS</button>
      <button class="chip" data-platform="azure" type="button">ğŸ”· Azure</button>
      <button class="chip" data-platform="gcp" type="button">ğŸŒ GCP</button>
      <button class="chip" data-platform="terraform" type="button">âš™ï¸ Terraform</button>
    </div>

    <!-- INPUT CARD -->
    <div class="input-card">
      <div class="input-label" id="cmdInputLabel">// Enter Command</div>
      <div class="input-row">
        <input id="cmdInput" class="cmd-input" type="text" placeholder="e.g. kubectl get pods -n production --watch"
          autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" maxlength="500"
          aria-label="CLI command to explain" aria-describedby="charCounter" />
        <button class="explain-btn" id="explainBtn" onclick="explainCommand()" type="button"
          aria-label="Explain this command">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"
            stroke-width="2.2" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
          </svg>
          Explain
        </button>
      </div>
      <div class="char-counter" id="charCounter" aria-live="polite">0 / 500</div>
    </div>

    <!-- EXAMPLES -->
    <div class="examples-label">// Quick examples</div>
    <div class="examples-row" id="examplesRow" role="list" aria-label="Example commands"></div>

    <!-- ERROR -->
    <div class="error-msg" id="errorMsg" role="alert" aria-live="assertive"></div>

    <!-- RESULTS -->
    <div id="results" style="display:none" aria-live="polite">
      <div class="summary-bar" id="summaryBar"></div>
      <div id="unknownNotice"></div>
      <div class="cmd-display" id="cmdDisplay" aria-label="Colour-coded command breakdown"></div>
      <div class="legend" aria-label="Token type legend">
        <div class="legend-item">
          <div class="legend-dot" style="background:var(--clr-cmd)" aria-hidden="true"></div>command
        </div>
        <div class="legend-item">
          <div class="legend-dot" style="background:var(--clr-sub)" aria-hidden="true"></div>subcommand
        </div>
        <div class="legend-item">
          <div class="legend-dot" style="background:var(--clr-flag)" aria-hidden="true"></div>flag / option
        </div>
        <div class="legend-item">
          <div class="legend-dot" style="background:var(--clr-arg)" aria-hidden="true"></div>argument
        </div>
        <div class="legend-item">
          <div class="legend-dot" style="background:var(--clr-val)" aria-hidden="true"></div>value
        </div>
        <div class="legend-item">
          <div class="legend-dot" style="background:var(--clr-pipe)" aria-hidden="true"></div>pipe / redirect
        </div>
        <div class="legend-item">
          <div class="legend-dot" style="background:var(--clr-other)" aria-hidden="true"></div>other
        </div>
      </div>
      <div class="parts-grid" id="partsGrid"></div>
    </div>

    <footer>CLIDecoder Â· 100% offline Â· no data sent anywhere Â· open in any browser</footer>
  </div>

  <!-- Knowledge base (external, keeps this file manageable) -->
  <script src="kb.js"></script>

  <script>
    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       CLIDecoder â€” Rule-based parser (no API key required)
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

    const MAX_LEN = 500;

    /* â”€â”€ EXAMPLES PER PLATFORM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    const EXAMPLES = {
      linux: ['ls -lah /var/log', 'grep -rn "error" ./logs --include="*.log"', 'tar -czvf backup.tar.gz /home/user', 'find / -name "*.conf" -type f 2>/dev/null', 'chmod 755 script.sh && ./script.sh', 'tail -f /var/log/syslog', 'ps aux | grep nginx', 'du -sh /* | sort -rh | head -10'],
      docker: ['docker run -d --name web -p 80:80 nginx', 'docker build -t myapp:v1 --no-cache .', 'docker ps -a', 'docker logs -f --tail=100 myapp', 'docker exec -it myapp /bin/bash', 'docker-compose up -d --build'],
      git: ['git log --oneline --graph --decorate', 'git commit -am "fix: resolve login issue"', 'git push origin main --force', 'git rebase -i HEAD~5', 'git stash pop', 'git diff HEAD~1 --stat'],
      kubernetes: ['kubectl get pods -n production --watch', 'kubectl apply -f deployment.yaml --dry-run=client', 'kubectl logs -f deploy/myapp -n staging --tail=100', 'kubectl exec -it pod/myapp-abc -n prod -- /bin/sh', 'kubectl rollout restart deployment/myapp -n prod', 'kubectl scale deployment myapp --replicas=5'],
      aws: ['aws s3 cp ./dist s3://my-bucket/ --recursive --acl public-read', 'aws ec2 describe-instances --filters "Name=tag:Env,Values=prod" --region us-east-1', 'aws iam attach-role-policy --role-name MyRole --policy-arn arn:aws:iam::aws:policy/ReadOnlyAccess', 'aws logs tail /aws/lambda/myFunction --follow'],
      azure: ['az vm create --name myVM --resource-group myRG --image UbuntuLTS --generate-ssh-keys', 'az storage blob upload --file ./data.csv --container mycontainer --name data.csv --account-name mystorage', 'az acr build --registry myRegistry --image myimage:v1 .'],
      gcp: ['gcloud compute instances create my-vm --zone=us-central1-a --machine-type=e2-medium', 'gsutil cp -r gs://source-bucket/* gs://dest-bucket/', 'gcloud container clusters get-credentials my-cluster --zone us-central1', 'gcloud run deploy myapp --image gcr.io/proj/myapp --allow-unauthenticated'],
      terraform: ['terraform plan -var-file=prod.tfvars -out=tfplan', 'terraform apply -auto-approve -parallelism=20', 'terraform state rm module.vpc.aws_subnet.public', 'terraform fmt -recursive', 'terraform workspace select production'],
    };

    let activePlatform = 'linux';

    /* â”€â”€ PLATFORM CHIPS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    document.querySelectorAll('.chip').forEach(chip => {
      chip.addEventListener('click', () => {
        document.querySelectorAll('.chip').forEach(c => { c.classList.remove('active'); c.removeAttribute('aria-pressed'); });
        chip.classList.add('active');
        chip.setAttribute('aria-pressed', 'true');
        activePlatform = chip.dataset.platform;
        renderExamples();
      });
      if (chip.dataset.platform === activePlatform) chip.setAttribute('aria-pressed', 'true');
    });

    function renderExamples() {
      const row = document.getElementById('examplesRow');
      row.innerHTML = '';
      (EXAMPLES[activePlatform] || []).forEach(text => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'example-pill';
        btn.setAttribute('role', 'listitem');
        btn.textContent = text;
        btn.addEventListener('click', () => {
          document.getElementById('cmdInput').value = text;
          updateCharCounter(text.length);
          explainCommand();
        });
        row.appendChild(btn);
      });
    }
    renderExamples();

    /* â”€â”€ CHAR COUNTER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    function updateCharCounter(len) {
      const el = document.getElementById('charCounter');
      el.textContent = `${len} / ${MAX_LEN}`;
      el.className = 'char-counter' + (len >= MAX_LEN ? ' limit' : len >= MAX_LEN * 0.8 ? ' warn' : '');
    }
    document.getElementById('cmdInput').addEventListener('input', e => updateCharCounter(e.target.value.length));

    /* â”€â”€ THEME â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    function applyTheme(t) {
      document.documentElement.dataset.theme = t;
      localStorage.setItem('clidecoder_theme', t);
      const dark = t === 'dark';
      document.getElementById('themeLabel').textContent = dark ? 'Light Mode' : 'Dark Mode';
      document.getElementById('themeIcon').innerHTML = dark
        ? `<path stroke-linecap="round" stroke-linejoin="round" d="M21 12.79A9 9 0 1111.21 3a7 7 0 009.79 9.79z"/>`
        : `<path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364-6.364l-.707.707M6.343 17.657l-.707.707M17.657 17.657l-.707-.707M6.343 6.343l-.707-.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>`;
    }
    function toggleTheme() { applyTheme(document.documentElement.dataset.theme === 'dark' ? 'light' : 'dark'); }
    (function () { const s = localStorage.getItem('clidecoder_theme'); if (s === 'light' || s === 'dark') applyTheme(s); })();

    /* â”€â”€ ENTER KEY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    document.getElementById('cmdInput').addEventListener('keydown', e => { if (e.key === 'Enter') explainCommand(); });

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PARSER ENGINE
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

    /** Tokenise respecting single/double quotes */
    function tokenise(input) {
      const tokens = [];
      let cur = '', inS = false, inD = false;
      for (let i = 0; i < input.length; i++) {
        const ch = input[i];
        if (ch === "'" && !inD) { inS = !inS; cur += ch; }
        else if (ch === '"' && !inS) { inD = !inD; cur += ch; }
        else if (ch === ' ' && !inS && !inD) { if (cur) tokens.push(cur); cur = ''; }
        else cur += ch;
      }
      if (cur) tokens.push(cur);
      return tokens;
    }

    /** Multi-word pipe/redirect operators that may appear as separate tokens */
    const MULTI_PIPE = new Set(['2>&1', '2>/dev/null', '1>&2', '&>/dev/null']);
    const SINGLE_PIPE = new Set(['|', '||', '&&', ';', '&', '>', '>>', '<', '<<', '2>', '1>', '1>>', '&>']);
    const ASSIGN_RE = /^[A-Za-z_][A-Za-z0-9_]*=/;  // VAR=value
    const FLAG_RE = /^--?[a-zA-Z]/;               // -x or --long

    /** Classify a sequence of raw tokens into typed tokens */
    function classify(rawTokens) {
      const result = [];
      let cmdEntry = null;      // KB entry for the base command
      let cmdFound = false;     // have we seen the main command?
      let subFound = false;     // have we seen the subcommand?
      let nextIsVal = false;    // next token should be typed as 'val' (flag value)
      let subCmds = 0;          // how many sub words seen for compound cmds (aws s3, gcloud compute, etc.)
      const MAX_SUB = 2;        // maximum compound-command depth

      for (let i = 0; i < rawTokens.length; i++) {
        const tok = rawTokens[i];

        // â”€â”€ PIPE / REDIRECT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        if (SINGLE_PIPE.has(tok) || MULTI_PIPE.has(tok)) {
          result.push({ text: tok, type: 'pipe', desc: describePipe(tok) });
          // after a pipe the next token is a new command
          cmdEntry = null; cmdFound = false; subFound = false; nextIsVal = false; subCmds = 0;
          continue;
        }

        // â”€â”€ ENVIRONMENT ASSIGNMENT (VAR=value before command) â”€â”€â”€â”€â”€â”€â”€â”€â”€
        if (!cmdFound && ASSIGN_RE.test(tok)) {
          result.push({ text: tok, type: 'other', desc: 'Environment variable set for this command' });
          continue;
        }

        // â”€â”€ BASE COMMAND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        if (!cmdFound) {
          // strip sudo prefix silently â€” it IS the cmd
          const base = tok.replace(/^.*\//, ''); // handle /usr/bin/ls â†’ ls
          cmdEntry = KB[base] || null;
          result.push({ text: tok, type: 'cmd', desc: cmdEntry ? cmdEntry.desc : `${base} command` });
          cmdFound = true;
          continue;
        }

        // â”€â”€ FLAG (starts with - ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        if (FLAG_RE.test(tok)) {
          nextIsVal = flagTakesValue(tok);
          const desc = (cmdEntry ? lookupFlag(cmdEntry, tok) : null) || genericFlagDesc(tok);
          result.push({ text: tok, type: 'flag', desc });
          continue;
        }

        // â”€â”€ VALUE expected after a flag â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        if (nextIsVal) {
          nextIsVal = false;
          result.push({ text: tok, type: 'val', desc: describeValue(tok) });
          continue;
        }

        // â”€â”€ SUBCOMMAND / POSITIONAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        if (cmdEntry && !subFound && subCmds < MAX_SUB) {
          const subDesc = lookupSub(cmdEntry, tok);
          if (subDesc) {
            // If the subcommand itself has sub-entries (e.g. aws â†’ s3 â†’ cp), try chaining
            if (cmdEntry.sub && cmdEntry.sub[tok] && typeof cmdEntry.sub[tok] === 'object') {
              cmdEntry = { desc: cmdEntry.sub[tok].desc || cmdEntry.sub[tok], sub: cmdEntry.sub[tok].sub, flags: Object.assign({}, cmdEntry.flags, cmdEntry.sub[tok].flags) };
            }
            result.push({ text: tok, type: 'sub', desc: subDesc });
            subCmds++;
            if (subCmds >= MAX_SUB) subFound = true;
            continue;
          }
          // If first positional after a known compound cmd (aws, gcloud etc.) is unknown sub
          if (subCmds === 0 && cmdEntry.sub) {
            result.push({ text: tok, type: 'sub', desc: `Subcommand for ${result[0]?.text || ''}` });
            subCmds++;
            continue;
          }
        }

        // â”€â”€ GENERIC POSITIONAL: path/URL/resource/value â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 
        result.push({ text: tok, type: guessPositionalType(tok), desc: describePositional(tok) });
      }

      return result;
    }

    /** Flags that commonly take a value as the next token */
    const VALUE_FLAGS = new Set([
      '-n', '-o', '-e', '-f', '-d', '-u', '-g', '-p', '-t', '-c', '-m', '-i', '-I', '-L', '-R', '-A', '-B', '-C',
      '-w', '-j', '-k', '-T', '-s', '-S', '-x', '-z', '-v',
      '--name', '--file', '--output', '--format', '--filter', '--query', '--region', '--profile', '--cluster',
      '--namespace', '--context', '--image', '--tag', '--type', '--role', '--policy', '--user', '--group',
      '--resource-group', '--location', '--subscription', '--account', '--project', '--zone', '--platform',
      '--runtime', '--handler', '--timeout', '--memory', '--entry-point', '--source', '--registry',
      '--container', '--account-name', '--service', '--template-file', '--parameters', '--stack-name',
      '--log-group-name', '--log-stream-name', '--cluster-name', '--node-count', '--size', '--sku',
      '--tier', '--var-file', '--var', '--out', '--parallelism', '--target', '--replace', '--sort-by',
      '--limit', '--member', '--key', '--secret', '--cert', '--scope', '--assignee', '--roles',
      '--replicas', '--tail', '--since', '--until', '--port', '--selector', '--labels', '-l',
      '--verbosity', '--machine-type', '--node-vm-size', '--disk-size', '--subnets', '--tags',
      '--function-name', '--values', '--version', '--set', '--max-items', '--page-size',
    ]);

    function flagTakesValue(flag) {
      const bare = flag.replace(/=.*$/, '');
      if (flag.includes('=')) return false; // --flag=val is self-contained
      return VALUE_FLAGS.has(bare);
    }

    function describePipe(op) {
      const m = { '|': 'Pipe stdout of left command to stdin of right', '&&': 'Run right command only if left succeeds (AND)', '||': 'Run right command only if left fails (OR)', ';': 'Run commands sequentially regardless of exit code', '&': 'Run command in background', '>>': 'Append stdout to file', '>': 'Redirect stdout to file (overwrite)', '<': 'Redirect file to stdin', '<<': 'Here-document input', '2>&1': 'Redirect stderr to stdout', '2>/dev/null': 'Discard error output', '1>&2': 'Redirect stdout to stderr', '&>': 'Redirect stdout and stderr to file', '2>': 'Redirect stderr to file', '1>': 'Redirect stdout to file' };
      return m[op] || 'Pipe or redirect operator';
    }

    function genericFlagDesc(flag) {
      if (flag.startsWith('--')) return `Long-form option: ${flag.replace(/^--/, '').replace(/-/g, ' ')}`;
      if (flag.startsWith('-') && flag.length === 2) return `Short option flag`;
      if (flag.startsWith('-') && flag.length > 2) return `Combined short flags: ${flag.slice(1).split('').map(c => '-' + c).join(' ')}`;
      return 'Command option flag';
    }

    function describeValue(v) {
      if (/^s3:\/\//.test(v)) return `S3 bucket URI: ${v}`;
      if (/^gs:\/\//.test(v)) return `GCS bucket URI: ${v}`;
      if (/^az:\/\//.test(v)) return `Azure storage URI: ${v}`;
      if (/^https?:\/\//.test(v)) return `URL: ${v}`;
      if (/^arn:/.test(v)) return `AWS ARN resource identifier`;
      if (/^sk-/.test(v)) return `API key value`;
      if (/^\d+$/.test(v)) return `Numeric value: ${v}`;
      if (/^[0-9]+[smhd]$/.test(v)) return `Time duration: ${v}`;
      if (/^[0-9]+[KMGTkmgt]?i?[Bb]?$/.test(v)) return `Size value: ${v}`;
      if (/^[a-z]{2,}-[a-z]+-[0-9]$/.test(v)) return `Cloud region / zone identifier`;
      if (/^[a-z][a-z0-9-]+\.[a-z][a-z0-9-]+/.test(v)) return `Domain or resource path`;
      if (/^\//.test(v)) return `Filesystem path: ${v}`;
      if (/^\.\//.test(v)) return `Relative path: ${v}`;
      if (/^~\//.test(v)) return `Home directory path`;
      if (v.includes(':')) return `Key-value or host:port pair`;
      return `Option value`;
    }

    function describePositional(tok) {
      // known resource types for k8s
      const k8s = { pods: 'Kubernetes Pod resources', deployments: 'Kubernetes Deployment resources', services: 'Kubernetes Service resources', nodes: 'Cluster Node resources', namespaces: 'Kubernetes Namespace list', configmaps: 'ConfigMap resources', secrets: 'Secret resources', ingresses: 'Ingress resources', statefulsets: 'StatefulSet resources', daemonsets: 'DaemonSet resources', 'persistentvolumeclaims': 'PersistentVolumeClaim resources', jobs: 'Job resources', cronjobs: 'CronJob resources', replicasets: 'ReplicaSet resources', events: 'Cluster event log', all: 'All resource types' };
      if (k8s[tok]) return k8s[tok];
      return describeValue(tok);
    }

    function guessPositionalType(tok) {
      if (/^s3:\/\/|^gs:\/\/|^https?:\/\/|^arn:|^\/|^\.\/|^~\//.test(tok)) return 'val';
      if (/^[a-zA-Z0-9_-]+\.[a-zA-Z]+$/.test(tok)) return 'val'; // file.ext
      return 'arg';
    }

    /** Count how well-known the command is */
    function coverageLevel(tokens) {
      let known = 0, total = tokens.filter(t => t.type !== 'pipe').length;
      tokens.forEach(t => { if (t.type !== 'pipe' && !t.desc.includes('Unknown') && !t.desc.match(/^(Short option flag|Command option flag|Long-form option|Subcommand for|Option value|command)$/)) known++; });
      if (total === 0) return 'none';
      const r = known / total;
      return r >= 0.8 ? 'full' : r >= 0.4 ? 'part' : 'none';
    }

    /* â”€â”€ MAIN EXPLAIN FUNCTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    function explainCommand() {
      const raw = document.getElementById('cmdInput').value.trim().slice(0, MAX_LEN);
      if (!raw) return;

      hideError();
      document.getElementById('results').style.display = 'none';

      try {
        const rawTokens = tokenise(raw);
        if (rawTokens.length === 0) return;

        const tokens = classify(rawTokens);
        renderResults(raw, tokens);
      } catch (err) {
        showError('âš  Could not parse the command: ' + escHtml(err.message));
        console.error('[CLIDecoder]', err);
      }
    }

    /* â”€â”€ RENDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    function renderResults(originalCmd, tokens) {
      const results = document.getElementById('results');
      const summaryBar = document.getElementById('summaryBar');
      const cmdDisplay = document.getElementById('cmdDisplay');
      const partsGrid = document.getElementById('partsGrid');
      const unknDiv = document.getElementById('unknownNotice');

      // Summary bar
      const cmdToken = tokens.find(t => t.type === 'cmd');
      const cmdName = cmdToken ? cmdToken.text.replace(/^.*\//, '') : '';
      const cmdEntry = KB[cmdName];
      const cover = coverageLevel(tokens);
      const badgeClass = cover === 'full' ? 'coverage-full' : cover === 'part' ? 'coverage-part' : 'coverage-none';
      const badgeText = cover === 'full' ? 'FULL COVERAGE' : cover === 'part' ? 'PARTIAL' : 'GENERIC';
      const summaryTxt = cmdEntry ? cmdEntry.desc : (cmdName ? `${cmdName} command breakdown` : 'Command breakdown');

      summaryBar.innerHTML = '';
      const strong = document.createElement('strong');
      strong.textContent = 'What it does: ';
      const txt = document.createTextNode(summaryTxt);
      const badge = document.createElement('span');
      badge.className = `coverage-badge ${badgeClass}`;
      badge.textContent = badgeText;
      summaryBar.appendChild(strong);
      summaryBar.appendChild(txt);
      summaryBar.appendChild(badge);

      // Unknown notice
      unknDiv.innerHTML = '';
      if (!cmdEntry && cmdName) {
        const notice = document.createElement('div');
        notice.className = 'unknown-notice';
        notice.textContent = `â„¹ "${cmdName}" is not in the built-in knowledge base. Flags and arguments are classified by common patterns. The tool, flag, and value colour-coding still applies.`;
        unknDiv.appendChild(notice);
      }

      // Coloured command display
      cmdDisplay.innerHTML = '';
      tokens.forEach((tok, i) => {
        const span = document.createElement('span');
        span.className = `t t-${tok.type}`;
        span.textContent = tok.text + (i < tokens.length - 1 ? ' ' : '');
        span.title = tok.desc;
        cmdDisplay.appendChild(span);
      });

      // Part cards â€” use DOM API exclusively (no innerHTML for user/KB data)
      partsGrid.innerHTML = '';
      tokens.forEach((tok, i) => {
        if (!tok.text.trim()) return;

        const card = document.createElement('div');
        card.className = 'part-card';
        card.style.animationDelay = `${i * 35}ms`;

        const header = document.createElement('div');
        header.className = 'part-card-header';

        const tokenSpan = document.createElement('span');
        tokenSpan.className = `part-token t-${tok.type}`;
        tokenSpan.textContent = tok.text;

        const badge = document.createElement('span');
        badge.className = 'part-type-badge';
        badge.style.color = `var(--clr-${tok.type})`;
        badge.textContent = tok.type;

        header.appendChild(tokenSpan);
        header.appendChild(badge);

        const desc = document.createElement('div');
        desc.className = 'part-desc' + (tok.desc.includes('flag') && !tok.desc.includes(' ') ? ' part-unknown' : '');
        desc.textContent = tok.desc;

        card.appendChild(header);
        card.appendChild(desc);
        partsGrid.appendChild(card);
      });

      results.style.display = 'block';
      results.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    /* â”€â”€ HELPERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    function hideError() { document.getElementById('errorMsg').classList.remove('visible'); }
    function showError(m) { const el = document.getElementById('errorMsg'); el.textContent = m; el.classList.add('visible'); }
    function escHtml(s) { return String(s).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;').replace(/'/g, '&#039;'); }
  </script>
</body>

</html>